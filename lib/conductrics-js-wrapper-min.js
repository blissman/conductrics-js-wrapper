(function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}};window.ConductricsJS=function(){function i(r,i,s){var o,u,a,f,l,c,h;this.owner=r,this.apikey=i,this.opts=s!=null?s:{},this.send=n(this.send,this),this.goal=n(this.goal,this),this.decision=n(this.decision,this),(o=this.opts).server==null&&(o.server="//api.conductrics.com"),(u=this.opts).timeout==null&&(u.timeout=5e3),(a=this.opts).cookies==null&&(a.cookies={ttl:2592e3,path:"/"}),(f=this.opts).scodestore==null&&(f.scodestore=e),(l=this.opts).session==null&&(l.session=typeof (c=this.opts).scodestore=="function"?c.scodestore("mpid"):void 0),(h=this.opts).transport==null&&(h.transport=t)}var r;return i.prototype.decision=function(e,t,n){var r,i,s,o,u;t==null&&(t={}),n==null&&(n=null),s=[e,"decisions"],r=null;if(t.choices!=null){u=t.choices;for(i in u){o=u[i];if((o!=null?o.join:void 0)==null)continue;s.push(""+i+":"+o.join(",")),r==null&&(r={}),r[i]||(r[i]={code:o[0]})}delete t.choices}return t.fallback!=null&&(r=t.fallback),this.send(s,t,function(e){var t,i;if(n==null)return;return t=(i=e!=null?e.decisions:void 0)!=null?i:r,n(t,e!=null?e.session:void 0)})},i.prototype.goal=function(e,t,n){var r;return r=[e,"goal"],t.goal!=null&&(r.push(t.goal),delete t.goal),this.send(r,t,function(e){var t;if(n==null)return;return t=(e!=null?e.session:void 0)!=null,n(t,e!=null?e.session:void 0)})},i.prototype.send=function(e,t,n){var i=this;return t==null&&(t={}),t.apikey=this.apikey,this.opts.session!=null&&(t.session=this.opts.session),t._t=(new Date).getTime(),e=""+this.opts.server+"/"+this.owner+"/"+e.join("/")+"?"+r(t),new this.opts.transport(e,this.opts.timeout,function(e){var t,r,s;try{r=JSON.parse(e),n(r)}catch(o){t=o,n(null)}if((r!=null?r.session:void 0)!=null&&i.opts.cookies!=null)return i.opts.session=r.session,typeof (s=i.opts).scodestore=="function"?s.scodestore("mpid",r.session,i.opts.cookies):void 0})},r=function(e){var t,n,r;n="";for(t in e)r=e[t],n+="&"+t+"="+escape(r);return n},i}(),e=function(e,t,n){var r;return arguments.length>1?(r=e+"="+escape(t)+(n.ttl!=null?"; expires="+(new Date(+(new Date)+1e3*n.ttl)).toUTCString():"")+(n.path!=null?"; path="+n.path:""),(n.domain!=null?"; domain="+n.domain:"")+(n.secure!=null?"; secure":""),document.cookie=r):unescape((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])},t=function(){function t(t,n,r){var i;i=e(t);if(i==null)return r(null);typeof n=="number"&&(i.timeout=n),i.onload=function(){return r(i.responseText)},i.onerror=i.ontimeout=function(){return r(null)},i.send()}var e;return e=function(e){var t;return typeof XMLHttpRequest!="undefined"&&XMLHttpRequest!==null&&(t=new XMLHttpRequest),(t!=null?t.withCredentials:void 0)!=null?t.open("GET",e,!0):typeof XDomainRequest!="undefined"&&XDomainRequest!==null?(t=new XDomainRequest,t.open("GET",e)):t=null,t},t}()}).call(this);